{extend name="public:base" /}

{block name="content"}

<table id="demo" lay-filter="test"></table>

<script type="text/html" id="barDemo">
    <a class="layui-btn layui-btn-xs" lay-event="detail">查看</a>
    <a class="layui-btn layui-btn-xs layui-btn-warm" lay-event="edit">编辑</a>
</script>

{/block}


{block name="script"}

<script type="text/javascript">
layui.use(['form','upload','jquery','layer'], function() {
    var form = layui.form,
        $ = layui.jquery,
        layer = layui.layer,
        table = layui.table;

    table.render({
        elem: '#demo'
        ,url: "{:url('')}"
        ,page: false
        ,limit : 20
        ,method:'post'
        ,cols: [[ //表头
            {field: 'aid', title: 'ID', width:80,fixed: 'left'}
            ,{field: 'info', title: '标题', width:280}
            ,{field: 'varname', title: '键值', width:160}
            ,{fixed: 'right', title:'操作', width:150, align:'center', toolbar: '#barDemo'}
        ]]
    });

    table.on('tool(test)', function(obj){
        var data = obj.data;
        var layEvent = obj.event;
        var tr = obj.tr;

        if(layEvent === 'detail'){
            layer.open({
                type : 2,
                title : '详情',
                area : ['600px', '420px'],
                content: "{:url('detail')}?aid=" + data.aid
            })

        } else if(layEvent === 'edit'){
            layer.open({
                type : 2,
                title : '编辑',
                area : ['600px', '420px'],
                content: "{:url('edit')}?aid=" + data.aid
            })
        }

    })

        // form.on('submit(submit)', function(data){
    //     $.post("{:url('')}", data.field, function(obj){
    //         if(obj.code == 200){
    //             layer.msg(obj.msg , {icon:1}, function(){
    //                 window.location.href = "{:url('index')}"
    //             })
    //         }else {
    //             layer.msg(obj.msg , {icon:2});
    //         }
    //     }, 'json')
    //     return false;
    // });

})

</script>
{/block}