{extend name="public:base" /}

{block name="style"}
<!--<script src="/static/admin/js/jquery-3.6.0.min.js" type="application/javascript"></script>-->
{/block}

{block name="content"}
<!--
<div>
    <form name='form1' action="{:url('tags_main', ['action'=>'fetch'])}" method="post" style="margin-bottom:6px;">
        <table width="98%" border="0" cellspacing="1" align="center" class="layui-table" >
            <tr>
                <td height="20" align="left" bgcolor="#F0FBBD" style="padding-left:10px;"><strong>提取TAG</strong></td>
            </tr>
            <tr>
                <td height="30" align="center" bgcolor="#Ffffff">
                    开始id:<input type="text" name="startaid" />
                    结束id:<input type="text" name="endaid" />
                    <input name="submit" type="submit" value="获取tags" class="layui-btn layui-btn-xs" />
                    <small>(tag以文档关键词为准)</small>
                </td>
            </tr>
        </table>
    </form>
</div>

<table lay-filter="" class="layui-table">
    <thead>
    <tr>
        <th lay-data="{field:'f1',width:'80'}">删</th>
        <th lay-data="{field:'f2',width:'280'}">标签</th>
        <th lay-data="{field:'f3',width:'180'}">点击</th>
        <th lay-data="{field:'f4',width:'80'}">文档数</th>
        <th lay-data="{field:'f5',width:'180'}">添加时间</th>
        <th lay-data="{field:'f6',width:'180'}">操作</th>
    </tr>
    </thead>
    <tbody>
    {volist name="_data" id="vo"}
    <tr>
        <td><input type="checkbox" name="ids[]" value="{$vo['aid']}" lay-skin="primary" /></td>
        <td>{$vo['tag']}</td>
        <td><input type='text' value="{$vo['count']}" id="count{$vo['id']}" size='5' /></td>
        <td>{$vo['total']}</td>
        <td>{$vo['addtime']|date='Y-m-d H:i:s'}</td>
        <td>
            <a href="javascript:UpdateOne({$vo->id})" class="layui-btn layui-btn-xs" lay-event="">[更新]</a>
            <a href="javascript:DeleteOne({$vo->id})" class="layui-btn layui-btn-xs layui-btn-danger" lay-event="">[删除]</a>
        </td>
    </tr>
    {/volist}
    </tbody>
</table>

-->
<div>
    <form class="layui-form" action="">
        <div class="layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">开始id:</label>
                <div class="layui-input-inline" style="width: 100px;">
                    <input type="text" name="startaid" placeholder="" autocomplete="off" class="layui-input">
                </div>
                <div class="layui-form-mid">开始id:</div>
                <div class="layui-input-inline" style="width: 100px;">
                    <input type="text" name="endaid" placeholder="" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-inline">
            <button class="layui-btn" data-type="reload">获取tags</button>
            </div>
        </div>

    </form>
</div>


<table id="demo" lay-filter="test"></table>

<script type="text/html" id="barDemo">
    <!--<a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>-->
    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
</script>
{/block}

{block name="script"}
<script>
// function UpdateOne(tid){
//     location = "{:url('tags_main_update')}?count="+document.getElementById('count'+tid).value+"&tid="+tid;
// }
//
// function DeleteOne(tid){
//     location = "{:url('tags_main_delete')}?action=delete&ids="+tid;
// }
</script>

<script>
layui.use(['table', 'jquery'], function(){
    var table = layui.table,
        $ = layui.jquery;

    //第一个实例
    table.render({
        elem: '#demo'
        ,url: "{:url('')}"
        ,method: 'post'
        ,request: {}
        ,response: {}
        ,page: true
        ,cols: [[ //表头
            {field: 'id', title: 'ID', width:80,fixed: 'left'}
            ,{field: 'tag', title: '标签', width:180}
            ,{field: 'count', title: '点击数', width:100}
            ,{field: 'total', title: '文档数:', width:80}
            ,{field: 'addtime', title: '时间', width:170}
            ,{fixed: 'right', width:70, align:'center', toolbar: '#barDemo'}
        ]]
    });

    table.on('tool(test)', function(obj){
        var data = obj.data;
        var layEvent = obj.event;
        var tr = obj.tr;
        if(layEvent === 'del'){
            layer.confirm('真的删除行么', function(index) {
                $.post("{:url('friendlink_delete')}", {ids:data.id}, function (objs) {
                    if(objs.code == 200) {
                        layer.msg(objs.msg, {icon: 1}, function () {
                            obj.del();
                            layer.close(index);
                        })
                    } else {
                        layer.msg(objs.msg, {icon: 2});
                    }
                }, 'json');
            })
        }else if(layEvent === 'edit'){
            // obj.update({
            //     username: '123'
            //     ,title: 'xxx'
            // });
            window.location.href = "{:url('tags_main_update')}?id=" +data.id + "&count=" + data.count;
        }

    })

});
</script>
{/block}
