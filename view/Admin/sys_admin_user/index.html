{extend name="public:base" /}

{block name="content"}
<a href="{:url('sys_admin_user_add')}" class="layui-btn layui-btn-xs" lay-event="detail">新增帐号</a>
<a href="{:url('/Admin/SysGroup')}" class="layui-btn layui-btn-xs" lay-event="detail">用户组管理</a>

<table id="demo" lay-filter="test"></table>

<script type="text/html" id="barDemo">
    <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="content_list">文档</a>
</script>
{/block}


{block name="script"}
<script type="text/javascript">
layui.use(['table', 'jquery'], function() {
    var table = layui.table,
        $ = layui.jquery;

    table.render({
        elem: '#demo'
        ,url: "{:url('')}"
        ,method: 'post'
        ,request: {}
        ,response: {}
        ,page: true
        ,cols: [[
            {field: 'id', title: 'ID', width:80,fixed: 'left'}
            ,{field: 'userid', title: '登录ID', width:80}
            ,{field: 'uname', title: '笔名', width:180}
            ,{field: 'usertype', title: '级别', width:90}
            ,{field: 'typename', title: '频道', width:90}
            ,{fixed: 'right', width:220, align:'center', toolbar: '#barDemo'}
        ]]
    });

    table.on('tool(test)', function(obj){
        var data = obj.data;
        var layEvent = obj.event;
        var tr = obj.tr;
        if(layEvent === 'del'){
            layer.confirm('真的删除行么', function(index) {
                $.post("{:url('sys_admin_user_delete')}", {id:data.id}, function (objs) {
                    if(objs.code == 200) {
                        layer.msg(objs.msg, {icon: 1}, function () {
                            obj.del();
                            layer.close(index);
                        })
                    } else {
                        layer.msg(objs.msg, {icon: 2});
                    }
                }, 'json');
            })
        }else if(layEvent === 'edit'){
            window.location.href = "{:url('sys_admin_user_edit')}?id=" +data.id;
        }

    })

})
</script>
{/block}